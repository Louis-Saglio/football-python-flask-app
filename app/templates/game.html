<html>
  <head>
    <link
      href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <!-- <link rel="stylesheet" href="/static/style.css" type="text/css" /> -->
  </head>
  <body class="font-mono">
    <div class="container mx-auto m-auto px-3 text-center bg-white h-full">
      {%if game is defined %}

      <div class="w-full py-2" style="height:20%">
        <h1 class="uppercase font-bold text-xl md:text-3xl">
          Game details
        </h1>
        The most likely score for this game is :
        <span class="font-bold"
          >{{ game.team_1.name }} {{ game.result[0] }} - {{ game.result[1] }}
          {{ game.team_2.name }}</span
        >. <br />
        This result was obtained with the number of goals scored with the
        highest probability for both teams.
      </div>

      <div class="w-full py-2" style="height:30%">
        <div class="w-full">
          <h3 class="uppercase font-bold text-xl">
            Possible outcome with probability
          </h3>
        </div>
        <div class="flex">
          <div class="w-1/3 p-2">
            <div class="block text-center w-full flex">
              <img
                src="/static/img/{{ teams[game.team_1.name] }}"
                class="h-24 w-full"
              />
            </div>
            {{ game.proba_team_1 }}% chance of victory.
          </div>
          <div class="w-1/3 p-2">
            <div class="block text-center w-full flex">
              <img src="/static/img/equal.svg" class="h-24 w-full" />
            </div>
            {{ game.proba_draw }}% chance of draw.
          </div>
          <div class="w-1/3 p-2">
            <div class="block text-center w-full flex">
              <img
                src="/static/img/{{ teams[game.team_2.name] }}"
                class="h-24 w-full"
              />
            </div>
            {{ game.proba_team_2 }}% chance of victory.
          </div>
        </div>
      </div>
      <div class="w-full py-2 flex" style="height:50%">
        <div class="w-1/2">
          <h3 class="uppercase font-bold text-xl">{{ game.team_1.name }}</h3>
          <canvas id="team_1_proba"></canvas>
        </div>
        <div class="w-1/2">
          <h3 class="uppercase font-bold text-xl">{{ game.team_2.name }}</h3>
          <canvas id="team_2_proba"></canvas>
        </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
      <script>
        const to_percent = function(data) {
          return data.map(e => Math.round(e*10000)/100);
        };

        const bar_plot = function(data, id) {
          data = to_percent(data);
          const ctx = document.getElementById(id).getContext("2d");
          const color = id === 'team_1_proba'?'rgba(52, 152, 219,1.0)':'rgba(231, 76, 60,1.0)';
          const chart = new Chart(ctx, {
            type: "bar",
            data: {
              labels: [...Array(20).keys()],
              datasets: [
                {
                  label: "Probability",
                  backgroundColor: color,
                  borderColor: "rgba(255, 255, 255,1.0)",
                  data: data
                }
              ]
            },
            options: {
                scales: {
                    yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Percentage'
                    }
                    }],
                    xAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Number of goals'
                    }
                    }]
                }
            }
          });
        };

        bar_plot({{ game.team_1.proba_goals|safe }}, 'team_1_proba');
        bar_plot({{ game.team_2.proba_goals|safe }}, 'team_2_proba');
      </script>
      {%else%} no game {%endif%}
    </div>
  </body>
</html>
